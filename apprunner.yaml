version: 1.0
runtime: nodejs18
build:
  commands:
    pre-build:
      - npm install -g typescript
      - npm install -g @nestjs/cli
      - npm ci
    build:
      - npx prisma generate
      - npm run build
run:
  runtime-version: 18.20.4
  command: cd /app && npm run start:prod
  network:
    port: 3001
    env: PORT
# env:
#   - name: NODE_ENV
#     value: production
#   - name: DATABASE_URL
#     value: "your-database-url-here"
#   # Add other environment variables as needed
# secrets:
#   - name: DATABASE_PASSWORD
#     valueFrom: "arn:aws:secretsmanager:region:account:secret:database-password"
# instance:
#   cpu: 1 vCPU
#   memory: 2 GB
#   instance-role-arn: arn:aws:iam::account:role/service-role/AppRunnerServiceRole
# health-check:
#   protocol: TCP
#   path: /health
#   interval: 10
#   timeout: 5
#   healthy-threshold: 2
#   unhealthy-threshold: 3